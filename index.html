<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LingoDash - Fun Language Learning</title>
    <!-- React and ReactDOM Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel: This allows the browser to understand JSX/React code -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');
        body { font-family: 'Nunito', sans-serif; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        // We define the icons manually since we aren't using the 'lucide-react' npm package
        const Globe = ({ size = 24, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
        );
        const XCircle = ({ onClick, className }) => (
            <svg onClick={onClick} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
        );
        const Trophy = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
        );
        const Flame = ({ size = 24, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>
        );
        const Star = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        );
        const ChevronLeft = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>
        );
        const Lock = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        );
        const CheckCircle2 = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>
        );

        const { useState, useEffect } = React;

        // --- DICTIONARY DATA ---
        const DICTIONARY = {
          pronouns: {
            'I': { es: 'Yo', fr: 'Je', de: 'Ich', it: 'Io', da: 'Jeg', nl: 'Ik', sv: 'Jag', no: 'Jeg', pt: 'Eu', pl: 'Ja' },
            'He': { es: 'Ã‰l', fr: 'Il', de: 'Er', it: 'Lui', da: 'Han', nl: 'Hij', sv: 'Han', no: 'Han', pt: 'Ele', pl: 'On' },
            'She': { es: 'Ella', fr: 'Elle', de: 'Sie', it: 'Lei', da: 'Hun', nl: 'Zij', sv: 'Hon', no: 'Hun', pt: 'Ela', pl: 'Ona' },
            'You': { es: 'TÃº', fr: 'Tu', de: 'Du', it: 'Tu', da: 'Du', nl: 'Jij', sv: 'Du', no: 'Du', pt: 'Tu', pl: 'Ty' }
          },
          verbs: {
            'eat': { es: 'comer', fr: 'manger', de: 'essen', it: 'mangiare', da: 'spise', nl: 'eten', sv: 'Ã¤ta', no: 'spise', pt: 'comer', pl: 'jeÅ›Ä‡' },
            'speak': { es: 'hablar', fr: 'parler', de: 'sprechen', it: 'parlare', da: 'tale', nl: 'spreken', sv: 'tala', no: 'snakke', pt: 'falar', pl: 'mÃ³wiÄ‡' },
            'want': { es: 'querer', fr: 'vouloir', de: 'wollen', it: 'volere', da: 'vil have', nl: 'willen', sv: 'vill ha', no: 'vil ha', pt: 'querer', pl: 'chcieÄ‡' },
            'see': { es: 'ver', fr: 'voir', de: 'sehen', it: 'vedere', da: 'se', nl: 'zien', sv: 'se', no: 'se', pt: 'ver', pl: 'widzieÄ‡' },
            'drink': { es: 'beber', fr: 'boire', de: 'trinken', it: 'bere', da: 'drikke', nl: 'drinken', sv: 'dricka', no: 'drikke', pt: 'beber', pl: 'piÄ‡' },
            'read': { es: 'leer', fr: 'lire', de: 'lesen', it: 'leggere', da: 'lÃ¦se', nl: 'lezen', sv: 'lÃ¤sa', no: 'lese', pt: 'ler', pl: 'czytaÄ‡' },
            'run': { es: 'correr', fr: 'courir', de: 'laufen', it: 'correre', da: 'lÃ¸be', nl: 'rennen', sv: 'springa', no: 'lÃ¸pe', pt: 'correr', pl: 'biegaÄ‡' },
            'write': { es: 'escribir', fr: 'Ã©crire', de: 'schreiben', it: 'schrivere', da: 'skrive', nl: 'schrijven', sv: 'skriva', no: 'skrive', pt: 'escrever', pl: 'pisaÄ‡' },
            'play': { es: 'jugar', fr: 'jouer', de: 'spielen', it: 'giocare', da: 'lege', nl: 'spelen', sv: 'spela', no: 'leke', pt: 'jogar', pl: 'graÄ‡' },
            'jump': { es: 'saltar', fr: 'sauter', de: 'springen', it: 'saltare', da: 'hoppe', nl: 'springen', sv: 'hoppa', no: 'hoppe', pt: 'pular', pl: 'skakaÄ‡' },
            'swim': { es: 'nadar', fr: 'nager', de: 'schwimmen', it: 'nuotare', da: 'svÃ¸mme', nl: 'zwemmen', sv: 'simma', no: 'svÃ¸mme', pt: 'nadar', pl: 'pÅ‚ywaÄ‡' },
            'dance': { es: 'bailar', fr: 'danser', de: 'tanzen', it: 'ballare', da: 'danse', nl: 'dansen', sv: 'dansa', no: 'danse', pt: 'danÃ§ar', pl: 'taÅ„czyÄ‡' },
            'sing': { es: 'cantar', fr: 'chanter', de: 'singen', it: 'cantare', da: 'synge', nl: 'zingen', sv: 'sjunga', no: 'synge', pt: 'cantar', pl: 'Å›piewaÄ‡' },
            'sleep': { es: 'dormir', fr: 'dormir', de: 'schlafen', it: 'dormire', da: 'sove', nl: 'slapen', sv: 'sova', no: 'sove', pt: 'dormir', pl: 'spaÄ‡' },
            'walk': { es: 'caminar', fr: 'marcher', de: 'gehen', it: 'camminare', da: 'gÃ¥', nl: 'lopen', sv: 'gÃ¥', no: 'gÃ¥', pt: 'caminhar', pl: 'spacerowaÄ‡' },
            'draw': { es: 'dibujar', fr: 'dessiner', de: 'zeichnen', it: 'disegnare', da: 'tegne', nl: 'tekenen', sv: 'rita', no: 'tegne', pt: 'desenhar', pl: 'rysowaÄ‡' },
            'cook': { es: 'cocinar', fr: 'cuisiner', de: 'kochen', it: 'cucinare', da: 'lave mad', nl: 'koken', sv: 'laga mat', no: 'lage mat', pt: 'cozinhar', pl: 'gotowaÄ‡' },
            'listen': { es: 'escuchar', fr: 'Ã©couter', de: 'hÃ¶ren', it: 'ascoltare', da: 'lytte', nl: 'luisteren', sv: 'lyssna', no: 'lytte', pt: 'ouvir', pl: 'sÅ‚uchaÄ‡' },
            'find': { es: 'encontrar', fr: 'trouver', de: 'finden', it: 'trovare', da: 'finde', nl: 'vinden', sv: 'hitta', no: 'finne', pt: 'encontrar', pl: 'znaleÅºÄ‡' },
            'learn': { es: 'aprender', fr: 'apprendre', de: 'lernen', it: 'imparare', da: 'lÃ¦re', nl: 'leren', sv: 'lÃ¤ra', no: 'lÃ¦re', pt: 'aprender', pl: 'uczyÄ‡ siÄ™' },
            'help': { es: 'ayudar', fr: 'aider', de: 'helfen', it: 'aiutare', da: 'hjÃ¦lpe', nl: 'helpen', sv: 'hjÃ¤lpa', no: 'hjelpe', pt: 'ajudar', pl: 'pomagaÄ‡' },
            'work': { es: 'trabajar', fr: 'travailler', de: 'arbeiten', it: 'lavorare', da: 'arbejde', nl: 'werken', sv: 'arbeta', no: 'jobbe', pt: 'trabalhar', pl: 'pracowaÄ‡' },
            'buy': { es: 'comprar', fr: 'acheter', de: 'kaufen', it: 'comprar', da: 'kÃ¸be', nl: 'kopen', sv: 'kÃ¶pa', no: 'kjÃ¸pe', pt: 'comprar', pl: 'kupowaÄ‡' },
            'love': { es: 'amar', fr: 'aimer', de: 'lieben', it: 'amare', da: 'elske', nl: 'liefhebben', sv: 'Ã¤lska', no: 'elske', pt: 'amar', pl: 'kochaÄ‡' }
          },
          nouns: {
            'apple': { es: 'manzana', fr: 'pomme', de: 'Apfel', it: 'mela', da: 'Ã¦ble', nl: 'appel', sv: 'Ã¤pple', no: 'eple', pt: 'maÃ§Ã£', pl: 'jabÅ‚ko' },
            'bread': { es: 'pan', fr: 'pain', de: 'Brot', it: 'pane', da: 'brÃ¸d', nl: 'brood', sv: 'brÃ¶d', no: 'brÃ¸d', pt: 'pÃ£o', pl: 'chleb' },
            'water': { es: 'agua', fr: 'eau', de: 'Wasser', it: 'acqua', da: 'vand', nl: 'water', sv: 'vatten', no: 'vann', pt: 'Ã¡gua', pl: 'woda' },
            'milk': { es: 'leche', fr: 'lait', de: 'Milch', it: 'latte', da: 'mÃ¦lk', nl: 'melk', sv: 'mjÃ¶lk', no: 'melk', pt: 'leite', pl: 'mleko' },
            'book': { es: 'libro', fr: 'livre', de: 'Buch', it: 'libro', da: 'bog', nl: 'boek', sv: 'bok', no: 'bok', pt: 'livro', pl: 'ksiÄ…Å¼ka' },
            'cat': { es: 'gato', fr: 'chat', de: 'Katze', it: 'gatto', da: 'kat', nl: 'kat', sv: 'katt', no: 'katt', pt: 'gato', pl: 'kot' },
            'dog': { es: 'perro', fr: 'chien', de: 'Hund', it: 'cane', da: 'hund', nl: 'hond', sv: 'hund', no: 'hund', pt: 'cachorro', pl: 'pies' },
            'house': { es: 'casa', fr: 'maison', de: 'Haus', it: 'casa', da: 'hus', nl: 'huis', sv: 'hus', no: 'hus', pt: 'casa', pl: 'dom' },
            'tree': { es: 'Ã¡rbol', fr: 'arbre', de: 'Baum', it: 'albero', da: 'trÃ¦', nl: 'boom', sv: 'trÃ¤d', no: 'tre', pt: 'Ã¡rvore', pl: 'drzewo' },
            'flower': { es: 'flor', fr: 'fleur', de: 'Blume', it: 'fiore', da: 'blomst', nl: 'blomst', sv: 'blomma', no: 'blomst', pt: 'flor', pl: 'kwiat' },
            'bird': { es: 'pÃ¡jaro', fr: 'oiseau', de: 'Vogel', it: 'uccello', da: 'fugl', nl: 'vogel', sv: 'fÃ¥gel', no: 'fugl', pt: 'pÃ¡ssaro', pl: 'ptak' },
            'sun': { es: 'sol', fr: 'soleil', de: 'Sonne', it: 'sole', da: 'sol', nl: 'zon', sv: 'sol', no: 'sol', pt: 'sol', pl: 'sÅ‚oÅ„ce' },
            'moon': { es: 'luna', fr: 'lune', de: 'Mond', it: 'luna', da: 'mÃ¥ne', nl: 'maan', sv: 'mÃ¥ne', no: 'mÃ¥ne', pt: 'lua', pl: 'ksiÄ™Å¼yc' },
            'star': { es: 'estrella', fr: 'Ã©toile', de: 'Stern', it: 'stella', da: 'stjerne', nl: 'ster', sv: 'stjÃ¤rna', no: 'stjerne', pt: 'estrela', pl: 'gwiazda' },
            'car': { es: 'coche', fr: 'voiture', de: 'Auto', it: 'macchina', da: 'bil', nl: 'auto', sv: 'bil', no: 'bil', pt: 'carro', pl: 'samochÃ³d' },
            'ball': { es: 'pelota', fr: 'ballon', de: 'Ball', it: 'palla', da: 'bold', nl: 'bal', sv: 'boll', no: 'ball', pt: 'bola', pl: 'piÅ‚ka' },
            'hat': { es: 'sombrero', fr: 'chapeau', de: 'Hut', it: 'cappello', da: 'hat', nl: 'hoed', sv: 'hatt', no: 'hatt', pt: 'chapÃ©u', pl: 'kapelusz' },
            'shirt': { es: 'camisa', fr: 'chemise', de: 'Hemd', it: 'camicia', da: 'skjorte', nl: 'hemd', sv: 'skjorta', no: 'skjorte', pt: 'camisa', pl: 'koszula' },
            'shoe': { es: 'zapato', fr: 'chaussure', de: 'Schuh', it: 'scarpa', da: 'sko', nl: 'schoen', sv: 'sko', no: 'sko', pt: 'sapato', pl: 'but' },
            'table': { es: 'mesa', fr: 'table', de: 'Tisch', it: 'tavolo', da: 'bord', nl: 'tafel', sv: 'bord', no: 'bord', pt: 'mesa', pl: 'stÃ³Å‚' },
            'chair': { es: 'silla', fr: 'chaise', de: 'Stuhl', it: 'sedia', da: 'stol', nl: 'stoel', sv: 'stol', no: 'stol', pt: 'cadeira', pl: 'krzesÅ‚o' },
            'phone': { es: 'telÃ©fono', fr: 'tÃ©lÃ©phone', de: 'Telefon', it: 'telefono', da: 'telefon', nl: 'telefoon', sv: 'telefon', no: 'telefon', pt: 'telefone', pl: 'telefon' },
            'pen': { es: 'bolÃ­grafo', fr: 'stylo', de: 'Stift', it: 'penna', da: 'pen', nl: 'pen', sv: 'penna', no: 'penn', pt: 'caneta', pl: 'dÅ‚ugopis' },
            'computer': { es: 'computadora', fr: 'ordinateur', de: 'Computer', it: 'computer', da: 'computer', nl: 'computer', sv: 'dator', no: 'datamaskin', pt: 'computador', pl: 'komputer' }
          },
          colors: {
            'red': { es: 'rojo', fr: 'rouge', de: 'rot', it: 'rosso', da: 'rÃ¸d', nl: 'rood', sv: 'rÃ¶d', no: 'rÃ¸d', pt: 'vermelho', pl: 'czerwony' },
            'blue': { es: 'azul', fr: 'bleu', de: 'blau', it: 'blu', da: 'blÃ¥', nl: 'blauw', sv: 'blÃ¥', no: 'blÃ¥', pt: 'azul', pl: 'niebieski' },
            'green': { es: 'verde', fr: 'vert', de: 'grÃ¼n', it: 'verde', da: 'grÃ¸n', nl: 'groen', sv: 'grÃ¶n', no: 'grÃ¸nn', pt: 'verde', pl: 'zielony' },
            'yellow': { es: 'amarillo', fr: 'jaune', de: 'gelb', it: 'giallo', da: 'gul', nl: 'geel', sv: 'gul', no: 'gul', pt: 'amarelo', pl: 'Å¼Ã³Å‚ty' },
            'black': { es: 'negro', fr: 'noir', de: 'schwarz', it: 'nero', da: 'sort', nl: 'zwart', sv: 'svart', no: 'svart', pt: 'preto', pl: 'czarny' },
            'white': { es: 'blanco', fr: 'blanc', de: 'weiÃŸ', it: 'bianco', da: 'hvid', nl: 'wit', sv: 'vit', no: 'hvit', pt: 'branco', pl: 'biaÅ‚y' }
          },
          numbers: {
            'one': { es: 'uno', fr: 'un', de: 'eins', it: 'uno', da: 'en', nl: 'een', sv: 'ett', no: 'en', pt: 'um', pl: 'jeden' },
            'two': { es: 'dos', fr: 'deux', de: 'zwei', it: 'due', da: 'to', nl: 'twee', sv: 'tvÃ¥', no: 'to', pt: 'dois', pl: 'dwa' },
            'three': { es: 'tres', fr: 'trois', de: 'drei', it: 'tre', da: 'tre', nl: 'drie', sv: 'tre', no: 'tre', pt: 'trÃªs', pl: 'trzy' },
            'four': { es: 'cuatro', fr: 'quatre', de: 'vier', it: 'quattro', da: 'fire', nl: 'vier', sv: 'fyra', no: 'fire', pt: 'quatro', pl: 'cztery' },
            'five': { es: 'cinco', fr: 'cinq', de: 'fÃ¼nf', it: 'cinque', da: 'fem', nl: 'vijf', sv: 'fem', no: 'fem', pt: 'cinco', pl: 'piÄ™Ä‡' }
          },
          fallbacks: {
            'I': 'Jeg', 'He': 'Han', 'She': 'Hun', 'You': 'Du'
          }
        };

        const LANGUAGES = [
          { id: 'da', name: 'Danish', flag: 'ðŸ‡©ðŸ‡°', and: 'og' },
          { id: 'es', name: 'Spanish', flag: 'ðŸ‡ªðŸ‡¸', and: 'y' },
          { id: 'fr', name: 'French', flag: 'ðŸ‡«ðŸ‡·', and: 'et' },
          { id: 'de', name: 'German', flag: 'ðŸ‡©ðŸ‡ª', and: 'und' },
          { id: 'it', name: 'Italian', flag: 'ðŸ‡®ðŸ‡¹', and: 'e' },
          { id: 'pt', name: 'Portuguese', flag: 'ðŸ‡µðŸ‡¹', and: 'e' },
          { id: 'nl', name: 'Dutch', flag: 'ðŸ‡³ðŸ‡±', and: 'en' },
          { id: 'sv', name: 'Swedish', flag: 'ðŸ‡¸ðŸ‡ª', and: 'och' },
          { id: 'no', name: 'Norwegian', flag: 'ðŸ‡³ðŸ‡´', and: 'og' },
          { id: 'pl', name: 'Polish', flag: 'ðŸ‡µðŸ‡±', and: 'i' },
          { id: 'jp', name: 'Japanese', flag: 'ðŸ‡¯ðŸ‡µ', and: 'ã¨' },
          { id: 'kr', name: 'Korean', flag: 'ðŸ‡°ðŸ‡·', and: 'ê³ ' },
          { id: 'zh', name: 'Chinese', flag: 'ðŸ‡¨ðŸ‡³', and: 'å’Œ' },
          { id: 'ru', name: 'Russian', flag: 'ðŸ‡·ðŸ‡º', and: 'Ð¸' },
          { id: 'tr', name: 'Turkish', flag: 'ðŸ‡¹ðŸ‡·', and: 've' },
          { id: 'fi', name: 'Finnish', flag: 'ðŸ‡«ðŸ‡®', and: 'ja' },
          { id: 'gr', name: 'Greek', flag: 'ðŸ‡¬ðŸ‡·', and: 'ÎºÎ±Î¹' },
          { id: 'he', name: 'Hebrew', flag: 'ðŸ‡®ðŸ‡±', and: '×•' },
          { id: 'hi', name: 'Hindi', flag: 'ðŸ‡®ðŸ‡³', and: 'à¤”à¤°' },
          { id: 'th', name: 'Thai', flag: 'ðŸ‡¹ðŸ‡­', and: 'à¹à¸¥à¸°' },
          { id: 'vi', name: 'Vietnamese', flag: 'ðŸ‡»ðŸ‡³', and: 'vÃ ' },
          { id: 'id', name: 'Indonesian', flag: 'ðŸ‡®ðŸ‡©', and: 'dan' },
          { id: 'ro', name: 'Romanian', flag: 'ðŸ‡·ðŸ‡´', and: 'È™i' },
          { id: 'hu', name: 'Hungarian', flag: 'ðŸ‡­ðŸ‡º', and: 'Ã©s' },
          { id: 'ar', name: 'Arabic', flag: 'ðŸ‡¸ðŸ‡¦', and: 'Ùˆ' }
        ];

        const getWord = (category, key, langId) => {
          const entry = DICTIONARY[category][key];
          if (!entry) return DICTIONARY.fallbacks[key] || key;
          return entry[langId] || DICTIONARY.fallbacks[key] || key;
        };

        const generateLessonTasks = (lang, lessonIdx) => {
          const tasks = [];
          const lId = lang.id;
          const shuffle = (a) => [...a].sort(() => Math.random() - 0.5);

          const addWordFlow = (category, key, list) => {
            const foreign = getWord(category, key, lId);
            list.push({ 
              id: `intro-${key}-${Math.random()}`,
              type: 'tap', 
              prompt: `Learn the new word: "${key}"`, 
              options: shuffle([foreign, 'Hej', 'Goddag', 'Tak']), 
              answer: foreign 
            });
            list.push({ 
              id: `reverse-${key}-${Math.random()}`,
              type: 'tap', 
              prompt: `What does "${foreign}" mean?`, 
              options: shuffle([key, 'Large', 'Yellow', 'Fast']), 
              answer: key 
            });
          };

          if (lessonIdx === 0) {
            ['I', 'He'].forEach(k => addWordFlow('pronouns', k, tasks));
            const p1 = getWord('pronouns', 'I', lId);
            const p2 = getWord('pronouns', 'He', lId);
            tasks.push({ type: 'reorder', prompt: `Combine: "I and He"`, options: shuffle([p1, lang.and, p2]), answer: [p1, lang.and, p2] });
          } 
          else if (lessonIdx === 1) {
            ['She', 'You'].forEach(k => addWordFlow('pronouns', k, tasks));
            const p1 = getWord('pronouns', 'She', lId);
            const p2 = getWord('pronouns', 'You', lId);
            tasks.push({ type: 'reorder', prompt: `Combine: "She and You"`, options: shuffle([p1, lang.and, p2]), answer: [p1, lang.and, p2] });
          }
          else if (lessonIdx === 2) {
            const cols = Object.keys(DICTIONARY.colors).slice(0, 3);
            cols.forEach(k => addWordFlow('colors', k, tasks));
          }
          else if (lessonIdx === 3) {
            const nums = Object.keys(DICTIONARY.numbers).slice(0, 3);
            nums.forEach(k => addWordFlow('numbers', k, tasks));
          }
          else {
            const verbKeys = Object.keys(DICTIONARY.verbs);
            const nounKeys = Object.keys(DICTIONARY.nouns);
            const vK = verbKeys[(lessonIdx - 4) % verbKeys.length];
            const nK = nounKeys[(lessonIdx - 4) % nounKeys.length];
            addWordFlow('verbs', vK, tasks);
            addWordFlow('nouns', nK, tasks);
            const pF = getWord('pronouns', 'I', lId);
            const vF = getWord('verbs', vK, lId);
            const nF = getWord('nouns', nK, lId);
            tasks.push({
              type: 'reorder',
              prompt: `Translate: "I ${vK} ${nK}"`,
              options: shuffle([pF, vF, nF, lang.and]),
              answer: [pF, vF, nF]
            });
          }
          return tasks;
        };

        function App() {
          const [view, setView] = useState('landing');
          const [selectedLang, setSelectedLang] = useState(null);
          const [progress, setProgress] = useState(() => JSON.parse(localStorage.getItem('lingo_v4_prog') || '{}'));
          const [stats, setStats] = useState({ xp: 0, streak: 1 });
          const [currentTasks, setCurrentTasks] = useState([]);
          const [taskIdx, setTaskIdx] = useState(0);
          const [feedback, setFeedback] = useState(null);
          const [selection, setSelection] = useState(null);
          const [reorderList, setReorderList] = useState([]);

          useEffect(() => localStorage.setItem('lingo_v4_prog', JSON.stringify(progress)), [progress]);

          const startLesson = (idx) => {
            setCurrentTasks(generateLessonTasks(selectedLang, idx));
            setTaskIdx(0);
            setFeedback(null);
            setSelection(null);
            setReorderList([]);
            setView('lesson');
          };

          const handleCheck = () => {
            const task = currentTasks[taskIdx];
            const isCorrect = task.type === 'tap' ? selection === task.answer : JSON.stringify(reorderList) === JSON.stringify(task.answer);
            setFeedback(isCorrect ? 'correct' : 'wrong');
          };

          const handleNext = () => {
            if (taskIdx + 1 < currentTasks.length) {
              setTaskIdx(taskIdx + 1);
              setFeedback(null);
              setSelection(null);
              setReorderList([]);
            } else {
              const currentProg = progress[selectedLang.id] || 0;
              setProgress(prev => ({ ...prev, [selectedLang.id]: currentProg + 1 }));
              setStats(prev => ({ ...prev, xp: prev.xp + 20 }));
              setView('curriculum');
            }
          };

          if (view === 'landing') {
            return (
              <div className="min-h-screen bg-white p-6 flex flex-col items-center">
                <header className="w-full flex justify-between items-center mb-12 max-w-2xl">
                    <Globe className="text-green-600" size={32} />
                    <div className="flex gap-4 font-black text-orange-500 items-center"><Flame size={20} /> {stats.streak}</div>
                </header>
                <h1 className="text-4xl font-black mb-2 text-center">I want to learn...</h1>
                <p className="text-gray-400 font-bold mb-8 text-center uppercase tracking-wider text-xs tracking-[0.2em]">Safe Language Learning</p>
                <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 w-full max-w-5xl pb-10">
                  {LANGUAGES.map(l => (
                    <button key={l.id} onClick={() => { setSelectedLang(l); setView('curriculum'); }} className="p-4 border-4 border-gray-100 rounded-[28px] flex flex-col items-center gap-2 hover:bg-blue-50 transition-all active:scale-95 shadow-sm">
                      <span className="text-3xl">{l.flag}</span>
                      <span className="font-black text-gray-700 text-xs uppercase">{l.name}</span>
                    </button>
                  ))}
                </div>
              </div>
            );
          }

          if (view === 'curriculum') {
            const userProg = progress[selectedLang.id] || 0;
            return (
              <div className="min-h-screen bg-gray-50 flex flex-col">
                <header className="bg-white p-6 border-b sticky top-0 z-20 flex items-center justify-between">
                    <button onClick={() => setView('landing')} className="p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors"><ChevronLeft /></button>
                    <div className="font-black text-xl flex items-center gap-2">{selectedLang.flag} {selectedLang.name}</div>
                    <div className="flex items-center gap-2 font-black text-blue-600">XP: {stats.xp}</div>
                </header>
                <main className="flex-1 overflow-y-auto p-6 flex flex-col items-center gap-8 pb-32">
                    <div className="w-full max-w-md bg-green-500 p-8 rounded-[40px] text-white shadow-xl relative overflow-hidden">
                        <h2 className="text-2xl font-black">Unit 1: The Basics</h2>
                        <p className="font-bold opacity-80">Pronouns & Core Actions</p>
                        <Trophy className="absolute -right-4 -bottom-4 w-24 h-24 text-white/20 rotate-12" />
                    </div>
                    <div className="flex flex-col items-center gap-6">
                        {[...Array(20)].map((_, i) => {
                            const locked = i > userProg;
                            const done = i < userProg;
                            const labels = ['Basics 1', 'Basics 2', 'Colors', 'Numbers', 'Eat & Drink', 'Animals', 'Playtime', 'Nature', 'House', 'Clothing', 'Travel', 'Hobbies', 'Learning', 'Help!', 'Shopping'];
                            return (
                                <button key={i} disabled={locked} onClick={() => startLesson(i)} className={`w-20 h-20 rounded-full shadow-lg relative flex items-center justify-center transition-all ${locked ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : done ? 'bg-yellow-400 scale-90 opacity-80' : 'bg-blue-500 border-b-8 border-blue-700 active:border-b-0 active:translate-y-1'}`}>
                                    {locked ? <Lock /> : done ? <CheckCircle2 className="text-white" /> : <Star className="text-white fill-white" />}
                                    <div className="absolute -right-32 font-black text-gray-400 text-xs text-left w-28 uppercase">
                                        {labels[i] || 'Skill Mastery'}
                                    </div>
                                </button>
                            )
                        })}
                    </div>
                </main>
              </div>
            );
          }

          if (view === 'lesson') {
            const task = currentTasks[taskIdx];
            return (
              <div className="h-screen bg-white flex flex-col">
                <div className="p-6 pb-2">
                    <div className="flex items-center gap-4 mb-4">
                        <XCircle onClick={() => setView('curriculum')} className="text-gray-300 cursor-pointer hover:text-gray-500" />
                        <div className="flex-1 h-3 bg-gray-100 rounded-full overflow-hidden">
                            <div className="bg-green-500 h-full transition-all duration-500" style={{ width: `${(taskIdx / currentTasks.length) * 100}%` }} />
                        </div>
                    </div>
                </div>
                <div className="flex-1 overflow-y-auto px-6 pb-48 pt-4">
                    <div className="max-w-xl mx-auto w-full">
                        <div className="flex gap-4 mb-10 items-start">
                            <div className="text-5xl animate-bounce">ðŸ¦‰</div>
                            <div className="bg-white border-4 border-gray-100 p-6 rounded-[32px] font-black text-xl text-gray-800 shadow-sm flex-1 leading-tight">
                                {task.prompt}
                            </div>
                        </div>
                        {task.type === 'tap' ? (
                            <div className="grid grid-cols-1 gap-3">
                                {task.options.map((o, idx) => (
                                    <button key={idx} onClick={() => !feedback && setSelection(o)} className={`p-5 text-left border-2 rounded-2xl font-black text-lg transition-all active:scale-[0.98] ${selection === o ? 'border-blue-500 bg-blue-50 text-blue-700' : 'border-gray-100 hover:bg-gray-50'}`}>
                                        <span className="mr-3 text-gray-300 text-sm font-bold">{idx + 1}</span> {o}
                                    </button>
                                ))}
                            </div>
                        ) : (
                            <div className="flex flex-col gap-8">
                                <div className="min-h-[120px] border-b-4 border-dashed border-gray-200 p-4 flex flex-wrap gap-2 bg-gray-50 rounded-[32px]">
                                    {reorderList.map((w, i) => (
                                        <button key={i} onClick={() => !feedback && setReorderList(reorderList.filter((_, idx) => idx !== i))} className="p-3 bg-white border-2 border-gray-200 rounded-xl font-black shadow-md text-base">
                                            {w}
                                        </button>
                                    ))}
                                </div>
                                <div className="flex flex-wrap gap-2 justify-center">
                                    {task.options.map((o, i) => (
                                        <button key={i} onClick={() => !feedback && !reorderList.includes(o) && setReorderList([...reorderList, o])} className={`p-3 px-5 border-2 rounded-xl font-black text-base transition-all ${reorderList.includes(o) ? 'bg-gray-100 text-transparent border-gray-100 cursor-default' : 'bg-white border-gray-100 shadow-sm hover:border-gray-300 active:scale-95'}`}>
                                            {o}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
                <div className={`fixed bottom-0 left-0 right-0 max-w-xl mx-auto p-8 pt-4 transition-all border-t-4 rounded-t-[40px] shadow-2xl z-40 ${feedback === 'correct' ? 'bg-green-100 border-green-200' : feedback === 'wrong' ? 'bg-red-100 border-red-200' : 'bg-white'}`}>
                    {feedback && (
                        <div className="mb-4 flex items-center gap-4 animate-in slide-in-from-bottom duration-300">
                            <div className={`w-12 h-12 rounded-2xl flex items-center justify-center text-white text-2xl font-black ${feedback === 'correct' ? 'bg-green-500' : 'bg-red-500'}`}>
                                {feedback === 'correct' ? 'âœ“' : 'âœ•'}
                            </div>
                            <div>
                                <p className={`font-black text-xl ${feedback === 'correct' ? 'text-green-800' : 'text-red-800'}`}>
                                    {feedback === 'correct' ? 'Excellent!' : 'Oops, not quite!'}
                                </p>
                            </div>
                        </div>
                    )}
                    <button onClick={feedback ? handleNext : handleCheck} disabled={!feedback && !selection && reorderList.length === 0} className={`w-full py-5 rounded-2xl font-black text-white text-xl transition-all active:scale-95 shadow-lg ${feedback ? (feedback === 'correct' ? 'bg-green-500' : 'bg-red-500') : (!selection && reorderList.length === 0 ? 'bg-gray-200' : 'bg-green-500')}`}>
                        {feedback ? 'CONTINUE' : 'CHECK'}
                    </button>
                </div>
              </div>
            );
          }
          return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
